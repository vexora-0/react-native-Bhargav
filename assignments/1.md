* Homework brief (objectives, tasks, deliverables, grading)
* Minimal Node/Express + Mongoose product model, routes and server code
* Seed script to create a few example products
* React Native component that fetches product data and renders a FlatList
* How to run & test (curl/Postman) and common gotchas (CORS, device IP)

---

# Homework: Build a Server-backed Grocery Products List (Full stack, basic)

## Goal

Replace client-side placeholder products with a real server API. Students will build a minimal REST API for Products and change the front-end to fetch and display products from that API.

## Learning objectives

* Create a simple Mongoose model and Express routes
* Connect frontend to backend using fetch/axios
* Understand CORS, JSON APIs, and basic CRUD
* Seed a DB with example products and test API endpoints

## Tasks (required)

1. Create a Node + Express server with a `Product` model (Mongoose) and routes:

   * `GET /products` — list all products
   * `GET /products/:id` — get a single product
   * `POST /products` — create a product
2. Seed the database with at least 6 sample products (name, price, imageUrl, category, stock).
3. Update the React Native Grocery home screen:

   * Remove placeholder arrays
   * Fetch data from the `GET /products` endpoint
   * Render products using `FlatList`
   * Show loader and error UI
4. Deliverables:

   * Backend folder with code + seed script
   * Frontend code change (component file)
   * README with how to run both apps and test the endpoints
   * Optional: screenshots or a short demo GIF

## Optional (bonus)

* Add query parameters to `GET /products?category=Fruits`
* Add pagination: `GET /products?page=1&limit=10`
* Add search endpoint `GET /products?q=apple`
* Add update/delete routes and UI actions

## Grading (example)

* Backend correctness & routes: 35%
* Frontend integration & UI: 35%
* README + reproducibility: 20%
* Bonus features: 10%

---

# Minimal Backend (Node, Express, MongoDB + Mongoose)

Create a folder `backend/`. Below are minimal files.

### `models/Product.js`

```js
// models/Product.js
const mongoose = require('mongoose');

const ProductSchema = new mongoose.Schema({
  name: { type: String, required: true },
  price: { type: Number, required: true },
  imageUrl: { type: String },
  category: { type: String },
  description: { type: String },
  stock: { type: Number, default: 0 },
  createdAt: { type: Date, default: Date.now }
});

module.exports = mongoose.model('Product', ProductSchema);
```

### `routes/products.js`

```js
// routes/products.js
const express = require('express');
const router = express.Router();
const Product = require('../models/Product');

// GET /products  (optionally support ?q=&category=)
router.get('/', async (req, res) => {
  try {
    const { q, category } = req.query;
    const filter = {};
    if (q) filter.name = { $regex: q, $options: 'i' };
    if (category) filter.category = category;
    const products = await Product.find(filter).limit(100);
    res.json(products);
  } catch (err) {
    res.status(500).json({ error: 'Server error' });
  }
});

// GET /products/:id
router.get('/:id', async (req, res) => {
  try {
    const p = await Product.findById(req.params.id);
    if (!p) return res.status(404).json({ error: 'Product not found' });
    res.json(p);
  } catch (err) {
    res.status(500).json({ error: 'Server error' });
  }
});

// POST /products
router.post('/', async (req, res) => {
  try {
    const { name, price, imageUrl, category, description, stock } = req.body;
    const product = new Product({ name, price, imageUrl, category, description, stock });
    await product.save();
    res.status(201).json(product);
  } catch (err) {
    res.status(400).json({ error: 'Bad request', details: err.message });
  }
});

module.exports = router;
```

### `server.js`

```js
// server.js
const express = require('express');
const mongoose = require('mongoose');
const cors = require('cors');
const productsRouter = require('./routes/products');

const app = express();
app.use(cors());
app.use(express.json());

app.use('/products', productsRouter);

const PORT = process.env.PORT || 5000;
const MONGO_URI = process.env.MONGO_URI || 'mongodb://localhost:27017/grocery_homework';

mongoose.connect(MONGO_URI, { useNewUrlParser: true, useUnifiedTopology: true })
  .then(() => {
    console.log('Mongo connected');
    app.listen(PORT, () => console.log(`Server running on port ${PORT}`));
  })
  .catch(err => {
    console.error('Mongo connection error', err);
  });
```

### `seed.js` (to create initial products)

```js
// seed.js
const mongoose = require('mongoose');
const Product = require('./models/Product');

const MONGO_URI = process.env.MONGO_URI || 'mongodb://localhost:27017/grocery_homework';

const seedProducts = [
  { name: 'Red Apple', price: 40, imageUrl: 'https://via.placeholder.com/150', category: 'Fruits', stock: 50, description: 'Fresh red apples' },
  { name: 'Banana Bunch', price: 30, imageUrl: 'https://via.placeholder.com/150', category: 'Fruits', stock: 100 },
  { name: 'Spinach Pack', price: 20, imageUrl: 'https://via.placeholder.com/150', category: 'Vegetables', stock: 70 },
  { name: 'Milk 1L', price: 50, imageUrl: 'https://via.placeholder.com/150', category: 'Dairy', stock: 200 },
  { name: 'Paneer 200g', price: 120, imageUrl: 'https://via.placeholder.com/150', category: 'Dairy', stock: 40 },
  { name: 'Carrot kg', price: 35, imageUrl: 'https://via.placeholder.com/150', category: 'Vegetables', stock: 80 }
];

mongoose.connect(MONGO_URI, { useNewUrlParser: true, useUnifiedTopology: true })
  .then(async () => {
    console.log('Connected to mongo — seeding...');
    await Product.deleteMany({});
    await Product.insertMany(seedProducts);
    console.log('Seed complete');
    process.exit(0);
  })
  .catch(err => {
    console.error(err);
    process.exit(1);
  });
```

### `package.json` (quick)

```json
{
  "name": "grocery-backend",
  "version": "1.0.0",
  "main": "server.js",
  "scripts": {
    "start": "node server.js",
    "seed": "node seed.js"
  },
  "dependencies": {
    "cors": "^2.8.5",
    "express": "^4.18.2",
    "mongoose": "^7.0.0"
  }
}
```

---

# Minimal Frontend change (React Native) — fetch API and render FlatList

Replace your placeholder data and FlatList source with a fetch to the server.

### `ProductsScreen.js` (React Native functional component)

```jsx
// ProductsScreen.js
import React, { useEffect, useState } from 'react';
import { View, Text, FlatList, ActivityIndicator, Image, StyleSheet, SafeAreaView } from 'react-native';

const API_BASE = 'http://YOUR_COMPUTER_IP:5000'; // replace with actual IP or localhost if emulator

export default function ProductsScreen() {
  const [products, setProducts] = useState([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState(null);

  useEffect(() => {
    fetchProducts();
  }, []);

  async function fetchProducts() {
    try {
      setLoading(true);
      const resp = await fetch(`${API_BASE}/products`);
      if (!resp.ok) throw new Error('Failed to fetch');
      const data = await resp.json();
      setProducts(data);
    } catch (err) {
      setError(err.message || 'Error');
    } finally {
      setLoading(false);
    }
  }

  if (loading) return (
    <View style={styles.center}><ActivityIndicator size="large" /></View>
  );
  if (error) return (
    <View style={styles.center}><Text>Error: {error}</Text></View>
  );

  return (
    <SafeAreaView style={{flex:1}}>
      <FlatList
        data={products}
        keyExtractor={(item) => item._id}
        contentContainerStyle={{padding: 16}}
        renderItem={({item}) => (
          <View style={styles.card}>
            <Image source={{uri: item.imageUrl || 'https://via.placeholder.com/150'}} style={styles.img} />
            <View style={{flex:1, marginLeft:12}}>
              <Text style={styles.name}>{item.name}</Text>
              <Text style={styles.cat}>{item.category} • ₹{item.price}</Text>
              <Text style={styles.stock}>Stock: {item.stock}</Text>
            </View>
          </View>
        )}
      />
    </SafeAreaView>
  );
}

const styles = StyleSheet.create({
  center:{flex:1, alignItems:'center', justifyContent:'center'},
  card:{flexDirection:'row', backgroundColor:'#fff', padding:12, borderRadius:8, marginBottom:12, shadowColor:'#000', shadowOpacity:0.05, elevation:2},
  img:{width:72, height:72, borderRadius:6},
  name:{fontSize:16, fontWeight:'600'},
  cat:{color:'#666', marginTop:4},
  stock:{marginTop:6, color:'#333'}
});
```

**Important:** If testing on a real phone, replace `YOUR_COMPUTER_IP` with your machine's local network IP (e.g., `192.168.43.12`). If using Android emulator, `10.0.2.2:5000` can map to host localhost for the Android emulator.

---

# How to run & test

### Backend

1. `cd backend`
2. `npm install`
3. Ensure MongoDB is running locally or set `MONGO_URI` to a cloud URI.
4. `npm run seed` (fills DB)
5. `npm start` — server listens on port 5000

### Test endpoints (curl examples)

* List products:

```bash
curl http://localhost:5000/products
```

* Get single product:

```bash
curl http://localhost:5000/products/<PRODUCT_ID>
```

* Create product:

```bash
curl -X POST http://localhost:5000/products -H "Content-Type: application/json" -d '{"name":"Test","price":99}'
```

### Frontend

1. Ensure `API_BASE` in `ProductsScreen.js` points to backend host.
2. `npx react-native run-android` or `expo start` depending on your setup.
3. Open the app — it should fetch and show products.

---

# Common gotchas & tips

* CORS: server uses `cors()` already. If frontend still blocked, check console and network tab.
* Device vs Emulator: use correct host IP:

  * Android emulator: `10.0.2.2`
  * iOS simulator: `localhost` works
  * Real phone: use your machine LAN IP like `192.168.x.y`
* If images are slow, use placeholder images locally or via `https://via.placeholder.com`.
* If Mongo DB is remote (Atlas), set `MONGO_URI` env variable and allow your IP in Atlas.

---


